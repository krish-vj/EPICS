{% extends "base.html" %}
{% block content %}
<div class="container text-center mt-4">
    <div class="card shadow-sm">
        <div class="card-header bg-dark text-white">
            <h3>Video Consultation</h3>
            <small>Secure Room: {{ room_id }}</small>
        </div>
        <div class="card-body bg-black">
            <div class="row justify-content-center align-items-center" style="min-height: 400px;">
                <div class="col-md-5 position-relative">
                    <video id="localVideo" autoplay muted playsinline 
                           style="width: 100%; border-radius: 10px; border: 2px solid #0d6efd; transform: scaleX(-1);"></video>
                    <span class="badge bg-primary position-absolute top-0 start-0 m-3">You</span>
                </div>
                
                <div class="col-md-5 position-relative">
                    <video id="remoteVideo" autoplay playsinline 
                           style="width: 100%; border-radius: 10px; border: 2px solid #198754; background: #222;"></video>
                    <span class="badge bg-success position-absolute top-0 start-0 m-3">Remote User</span>
                    <div id="loadingMsg" class="text-white mt-5">Waiting for connection...</div>
                </div>
            </div>
        </div>
        <div class="card-footer">
            <button onclick="endCall()" class="btn btn-danger btn-lg px-5">
                <i class="bi bi-telephone-x"></i> End Call
            </button>
        </div>
    </div>
</div>

<!-- Socket.IO Client Library -->
<script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>

<!-- Room and User Variables -->
<script>
    const ROOM_ID = "{{ room_id }}";
    const CURRENT_USER = "{{ current_user.username }}";
</script>

<!-- WebRTC Logic -->
<script src="{{ url_for('static', filename='js/webrtc.js') }}"></script>
{% endblock %}